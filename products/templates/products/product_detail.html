{% extends 'products/base.html' %}
{% load static %}
{% load humanize %}

{% block content %}

<!-- Start Bradcaump area -->
<div class="ht__bradcaump__area bg-image--4">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="bradcaump__inner text-center">
          <h2 class="bradcaump-title">Shop Single</h2>
          <nav class="bradcaump-content">
            <a class="breadcrumb_item" href="index.html">Home</a>
            <span class="brd-separetor">/</span>
            <span class="breadcrumb_item active">Shop Single</span>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- End Bradcaump area -->

<div class="maincontent bg--white pt--80 pb--55">
  <div class="container">
    <div class="row">
      <div class="col-lg-9 col-12">
        <div class="wn__single__product">
          <div class="row">
            <div class="col-lg-6 col-12">
              <div class="wn__fotorama__wrapper">
                <div class="fotorama wn__fotorama__action" data-nav="thumbs">
                  {% for image in product.images.all %}
                  <a href=""><img src="{{ image.image.url }}" alt=""></a>
                  {% endfor %}
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-12">
              <div class="product__info__main">
                <h1>{{ product.name }}</h1>
                <div class="product-reviews-summary d-flex">
                  <ul class="rating-summary d-flex">
                    <li><i class="zmdi zmdi-star-outline"></i></li>
                    <li><i class="zmdi zmdi-star-outline"></i></li>
                    <li><i class="zmdi zmdi-star-outline"></i></li>
                    <li class="off"><i class="zmdi zmdi-star-outline"></i></li>
                    <li class="off"><i class="zmdi zmdi-star-outline"></i></li>
                  </ul>
                </div>
                <div class="price-box">
                  <span>{{ product.price | intcomma }}원</span>
                </div>
                <div class="product__overview">
                  {{ product.description }}
                </div>
                <div class="box-tocart d-flex">
                  <span>Qty</span>
                  <input id="qty" class="input-text qty" name="qty" min="1" value="1" title="Qty" type="number">
                  <div class="addtocart__actions">
                    <button class="tocart" type="submit" title="Add to Cart">Add to Cart</button>
                  </div>
                  <div class="product-addto-links clearfix">
                    <a class="wishlist like" href="{% url 'products:toggle_like' product.id %}" value="{{ product.id }}"
                      {% if like %}style="background-color: #e59285; background-position: 100% center;" {% endif %}></a>
                    <!-- <a class="compare" href="#"></a> -->
                  </div>
                </div>
                <div class="product_meta">
                  <span class="posted_in">Categories:
                    <a href="#">Adventure</a>,
                    <a href="#">Kids' Music</a>
                  </span>
                </div>
                <div class="product-share">
                  <ul>
                    <li class="categories-title">Share :</li>
                    <li>
                      <a href="#">
                        <i class="icon-social-twitter icons"></i>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="icon-social-tumblr icons"></i>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="icon-social-facebook icons"></i>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="icon-social-linkedin icons"></i>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="product__info__detailed">
          <div class="pro_details_nav nav justify-content-start" role="tablist">
            <a class="nav-item nav-link active" data-toggle="tab" href="#nav-details" role="tab">Details</a>
            <a class="nav-item nav-link" data-toggle="tab" href="#nav-review" role="tab">Reviews</a>
          </div>
          <div class="tab__container">
            <!-- Start Single Tab Content -->
            <div class="pro__tab_label tab-pane fade show active" id="nav-details" role="tabpanel">
              <div class="description__attribute">
                <p>Ideal for cold-weather training or work outdoors, the Chaz Hoodie promises superior warmth with every
                  wear. Thick material blocks out the wind as ribbed cuffs and bottom band seal in body heat.Ideal for
                  cold-weather training or work outdoors, the Chaz Hoodie promises superior warmth with every wear.
                  Thick material blocks out the wind as ribbed cuffs and bottom band seal in body heat.Ideal for
                  cold-weather training or work outdoors, the Chaz Hoodie promises superior warmth with every wear.
                  Thick material blocks out the wind as ribbed cuffs and bottom band seal in body heat.Ideal for
                  cold-weather training or work outdoors, the Chaz Hoodie promises superior warmth with every wear.
                  Thick material blocks out the wind as ribbed cuffs and bottom band seal in body heat.</p>
                <ul>
                  <li>• Two-tone gray heather hoodie.</li>
                  <li>• Drawstring-adjustable hood. </li>
                  <li>• Machine wash/dry.</li>
                </ul>
              </div>
            </div>
            <!-- End Single Tab Content -->
            <!-- Start Single Tab Content -->
            <div class="pro__tab_label tab-pane fade" id="nav-review" role="tabpanel">
              <div class="review__attribute">
                <h1>Customer Reviews</h1>
                <h2>Hastech</h2>
                <div class="review__ratings__type d-flex">
                  <div class="review-ratings">
                    <div class="rating-summary d-flex">
                      <span>Quality</span>
                      <ul class="rating d-flex">
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                      </ul>
                    </div>

                    <div class="rating-summary d-flex">
                      <span>Price</span>
                      <ul class="rating d-flex">
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                      </ul>
                    </div>
                    <div class="rating-summary d-flex">
                      <span>value</span>
                      <ul class="rating d-flex">
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                      </ul>
                    </div>
                  </div>
                  <div class="review-content">
                    <p>Hastech</p>
                    <p>Review by Hastech</p>
                    <p>Posted on 11/6/2018</p>
                  </div>
                </div>
              </div>
              <div class="review-fieldset">
                <h2>You're reviewing:</h2>
                <h3>Chaz Kangeroo Hoodie</h3>
                <div class="review-field-ratings">
                  <div class="product-review-table">
                    <div class="review-field-rating d-flex">
                      <span>Quality</span>
                      <ul class="rating d-flex">
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                      </ul>
                    </div>
                    <div class="review-field-rating d-flex">
                      <span>Price</span>
                      <ul class="rating d-flex">
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                      </ul>
                    </div>
                    <div class="review-field-rating d-flex">
                      <span>Value</span>
                      <ul class="rating d-flex">
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                        <li class="off"><i class="zmdi zmdi-star"></i></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="review_form_field">
                  <div class="input__box">
                    <span>Nickname</span>
                    <input id="nickname_field" type="text" name="nickname">
                  </div>
                  <div class="input__box">
                    <span>Summary</span>
                    <input id="summery_field" type="text" name="summery">
                  </div>
                  <div class="input__box">
                    <span>Review</span>
                    <textarea name="review"></textarea>
                  </div>
                  <div class="review-form-actions">
                    <button>Submit Review</button>
                  </div>
                </div>
              </div>
            </div>
            <!-- End Single Tab Content -->
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-12 md-mt-40 sm-mt-40">
        <div class="shop__sidebar">
          <aside class="wedget__categories poroduct--cat">
            <h3 class="wedget__title">Product Categories</h3>
            <ul>
              <li><a href="{% url 'products:product_list' %}">전체<span>({{ product_total_count }})</span></a></li>
              {% for category in category_list %}
              <li><a href="{% url 'products:product_list' %}?category={{ category.id }}">{{ category.name }}
                  <span>({{ category.product_count }})</span></a></li>
              {% endfor %}
            </ul>
          </aside>
          <aside class="wedget__categories pro--range">
            <h3 class="wedget__title">Filter by price</h3>
            <div class="content-shopby">
              <div class="price_filter s-filter clear">
                <form action="#" method="GET">
                  <div id="slider-range"
                    class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
                    <div class="ui-slider-range ui-widget-header ui-corner-all"
                      style="left: 20.4082%; width: 59.1837%;"></div><span
                      class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"
                      style="left: 20.4082%;"></span><span class="ui-slider-handle ui-state-default ui-corner-all"
                      tabindex="0" style="left: 79.5918%;"></span>
                  </div>
                  <div class="slider__range--output">
                    <div class="price__output--wrap">
                      <div class="price--output">
                        <span>Price :</span><input type="text" id="amount" readonly="">
                      </div>
                      <div class="price--filter">
                        <a href="#">Filter</a>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </aside>
          <aside class="wedget__categories poroduct--compare">
            <h3 class="wedget__title">Compare</h3>
            <ul>
              <li><a href="#">x</a><a href="#">Condimentum posuere</a></li>
            </ul>
          </aside>
          <aside class="wedget__categories poroduct--tag">
            <h3 class="wedget__title">Product Tags</h3>
            <ul>
              <li><a href="#">Biography</a></li>
            </ul>
          </aside>
          <aside class="wedget__categories sidebar--banner">
            <img src="images/others/banner_left.jpg" alt="banner images">
            <div class="text">
              <h2>new products</h2>
              <h6>save up to <br> <strong>40%</strong>off</h6>
            </div>
          </aside>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock content %}

{% block extra_js %}
<script src="{% static 'products/js/ajax.js' %}"></script>
<script>
  $('.like').click(function (e) {
    e.preventDefault();
    let product_id = $(this).attr('value');
    let url = "{% url 'products:toggle_like' 0 %}".replace('0', product_id);
    $.ajax({
      type: "POST",
      url: url,
      data: {
        product_id: product_id
      },
      success: function (res) {
        let is_existed = res.is_existed;
        let is_login = res.is_login;

        // 로그인하지 않은 유저의 요청일 경우 js로 리다이렉트를 해줍니다
        if (!is_login) { window.location.href = "{% url 'login' %}" }
        
        if (is_existed) {
          $('.like').css('background-color', '#e59285');
          $('.like').css('background-position-x', '100%');
          $('.like').css('background-position-y', 'center');
        } else {
          $('.like').css('background', '');
          $('.like').css('background-position-x', '');
          $('.like').css('background-position-y', '');
        }
      },
      error: function (request, status, error) {
        console.log(error);
      },
    });
  })
</script>
{% endblock extra_js %}